

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Do not shift an expression by a negative number of bits or by greater than or equal to the bitwidth of the operand &mdash; Safety-Critical Rust Coding Guidelines 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../_static/rust_playground.css?v=a15f506b" />
      <link rel="stylesheet" type="text/css" href="../../_static/citation.css?v=569c3786" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-data-viewer/jsonview.bundle.css?v=f6ef2277" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/libs/html/datatables.min.css?v=4b4fd840" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/common_css/need_toggle.css?v=5c6620df" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/common_css/needstable.css?v=5e1b6797" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/common_css/need_core.css?v=f5b60a78" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/common_css/need_links.css?v=2150a916" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/common_css/need_style.css?v=92936fa5" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/modern.css?v=803738c0" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=558c75d0" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/rust_playground.js?v=acd109cb"></script>
      <script src="../../_static/citation.js?v=1e6d5203"></script>
      <script src="../../_static/sphinx-data-viewer/jsonview.bundle.js?v=18cd53c5"></script>
      <script src="../../_static/sphinx-data-viewer/jsonview_loader.js?v=f7ff7e7d"></script>
      <script src="../../_static/sphinx-needs/libs/html/datatables.min.js?v=8a4aee21"></script>
      <script src="../../_static/sphinx-needs/libs/html/datatables_loader.js?v=a2cae175"></script>
      <script src="../../_static/sphinx-needs/libs/html/sphinx_needs_collapse.js?v=dca66431"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Ensure that integer operations do not result in arithmetic overflow" href="gui_dCquvqE1csI3.html" />
    <link rel="prev" title="An integer shall not be converted to a pointer" href="gui_PM8Vpf7lZ51U.html" /> 
<link rel="stylesheet" href="../../_static/fls_links.css" type="text/css" />
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Safety-Critical Rust Coding Guidelines
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Coding Guidelines</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../types-and-traits/index.html">Types and Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/index.html">Patterns</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Expressions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="gui_7y0GAMmtMhch.html">Do not use an integer type as a divisor during integer division</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_ADHABsmK9FXz.html">The ‘as’ operator should not be used with numeric operands</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_Bib7x9KmPq2nL.html">Example guideline with bibliography (gui_Bib7x9KmPq2nL)</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_Bob7x9KmPq2nL.html">Example guideline with bibliography (gui_Bob7x9KmPq2nL)</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_HDnAZ7EZ4z6G.html">Avoid as underscore pointer casts</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_LvmzGKdsAgI5.html">Avoid out-or-range shifts</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_PM8Vpf7lZ51U.html">An integer shall not be converted to a pointer</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Do not shift an expression by a negative number of bits or by greater than or equal to the bitwidth of the operand</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_dCquvqE1csI3.html">Ensure that integer operations do not result in arithmetic overflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_iv9yCMHRgpE0.html">An integer shall not be converted to an invalid pointer</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_kMbiWbn8Z6g5.html">Do not divide by 0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../values/index.html">Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statements/index.html">Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions/index.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../associated-items/index.html">Associated Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="../implementations/index.html">Implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generics/index.html">Generics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../attributes/index.html">Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entities-and-resolution/index.html">Entities And Resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ownership-and-destruction/index.html">Ownership And Destruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exceptions-and-errors/index.html">Exceptions And Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concurrency/index.html">Concurrency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../program-structure-and-compilation/index.html">Program Structure And Compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unsafety/index.html">Unsafety</a></li>
<li class="toctree-l2"><a class="reference internal" href="../macros/index.html">Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ffi/index.html">Ffi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inline-assembly/index.html">Inline Assembly</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../compliance/index.html">Compliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/index.html">Appendices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../retired-guidelines/index.html">Retired Guidelines</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Safety-Critical Rust Coding Guidelines</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Coding Guidelines</a></li>
          <li class="breadcrumb-item"><a href="index.html">Expressions</a></li>
      <li class="breadcrumb-item active">Do not shift an expression by a negative number of bits or by greater than or equal to the bitwidth of the operand</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/coding-guidelines/expressions/gui_RHvQj8BHlz9b.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="do-not-shift-an-expression-by-a-negative-number-of-bits-or-by-greater-than-or-equal-to-the-bitwidth-of-the-operand">
<h1>Do not shift an expression by a negative number of bits or by greater than or equal to the bitwidth of the operand<a class="headerlink" href="#do-not-shift-an-expression-by-a-negative-number-of-bits-or-by-greater-than-or-equal-to-the-bitwidth-of-the-operand" title="Link to this heading"></a></h1>
<div class="need_container docutils container" id="SNCB-4aa89231">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_guideline docutils align-default" id="gui_RHvQj8BHlz9b">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Guideline</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">Do not shift an expression by a negative number of bits or by greater than or equal to the bitwidth of the operand</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#gui_RHvQj8BHlz9b" title="gui_RHvQj8BHlz9b">gui_RHvQj8BHlz9b</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
<div class="line"><span class="needs_tags"><span class="needs_label">tags: </span><span class="needs_data_container"><span class="needs_data">numerics</span><span class="needs_spacer">, </span><span class="needs_data">reduce-human-error</span><span class="needs_spacer">, </span><span class="needs_data">maintainability</span><span class="needs_spacer">, </span><span class="needs_data">surprising-behavior</span><span class="needs_spacer">, </span><span class="needs_data">subset</span></span></span></div>
<div class="line"><span class="needs_category"><span class="needs_label">category: </span><span class="needs_data">advisory</span></span></div>
<div class="line"><span class="needs_fls"><span class="needs_label">fls: </span><span class="needs_data"><a href="https://rust-lang.github.io/fls/glossary.html#shift-left-expression" class="fls-id">fls_sru4wi5jomoe</a></span></span></div>
<div class="line"><span class="needs_decidability"><span class="needs_label">decidability: </span><span class="needs_data">decidable</span></span></div>
<div class="line"><span class="needs_scope"><span class="needs_label">scope: </span><span class="needs_data">module</span></span></div>
<div class="line"><span class="needs_release"><span class="needs_label">release: </span><span class="needs_data">1.7.0-latest</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">child needs: <span class="parent_needs"><span><a class="reference internal" href="#rat_3MpR8QfHodGT" title="gui_RHvQj8BHlz9b">rat_3MpR8QfHodGT</a>, <a class="reference internal" href="#non_compl_ex_O9FZuazu3Lcn" title="gui_RHvQj8BHlz9b">non_compl_ex_O9FZuazu3Lcn</a>, <a class="reference internal" href="#non_compl_ex_mvkgTL3kulZ5" title="gui_RHvQj8BHlz9b">non_compl_ex_mvkgTL3kulZ5</a>, <a class="reference internal" href="#non_compl_ex_O9FZuazu3Lcm" title="gui_RHvQj8BHlz9b">non_compl_ex_O9FZuazu3Lcm</a>, <a class="reference internal" href="#non_compl_ex_O9FZuazu3Lcx" title="gui_RHvQj8BHlz9b">non_compl_ex_O9FZuazu3Lcx</a>, <a class="reference internal" href="#non_compl_ex_O9FZuazu3Lcp" title="gui_RHvQj8BHlz9b">non_compl_ex_O9FZuazu3Lcp</a>, <a class="reference internal" href="#compl_ex_xpPQqYeEPGIo" title="gui_RHvQj8BHlz9b">compl_ex_xpPQqYeEPGIo</a>, <a class="reference internal" href="#bib_RHvQj8BHlz9b" title="gui_RHvQj8BHlz9b">bib_RHvQj8BHlz9b</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>Shifting negative positions or a value greater than or equal to the width of the left operand
in shift left and shift right expressions <a class="citation-ref reference internal" href="#cite-gui_RHvQj8BHlz9b-FLS-BIT-EXPRESSIONS">[FLS-BIT-EXPRESSIONS]</a>
are defined by this guideline to be <em>out-of-range shifts</em>.
The Rust FLS incorrectly describes this behavior as arithmetic overflow <a class="citation-ref reference internal" href="#cite-gui_RHvQj8BHlz9b-FLS-ISSUE-632">[FLS-ISSUE-632]</a>.</p>
<p>If the types of both operands are integer types,
the shift left expression <code class="docutils literal notranslate"><span class="pre">lhs</span> <span class="pre">&lt;&lt;</span> <span class="pre">rhs</span></code> evaluates to the value of the left operand <code class="docutils literal notranslate"><span class="pre">lhs</span></code> whose bits are
shifted left by the number of positions specified by the right operand <code class="docutils literal notranslate"><span class="pre">rhs</span></code>.
Vacated bits are filled with zeros.
The expression <code class="docutils literal notranslate"><span class="pre">lhs</span> <span class="pre">&lt;&lt;</span> <span class="pre">rhs</span></code> evaluates to <span class="math notranslate nohighlight">\(\mathrm{lhs} \times 2^{\mathrm{rhs}}\)</span>,
cast to the type of the left operand.
If the value of the right operand is negative or greater than or equal to the width of the left operand,
then the operation results in an out-of-range shift.</p>
<p>If the types of both operands are integer types,
the shift right expression <code class="docutils literal notranslate"><span class="pre">lhs</span> <span class="pre">&gt;&gt;</span> <span class="pre">rhs</span></code> evaluates to the value of the left operand <code class="docutils literal notranslate"><span class="pre">lhs</span></code>
whose bits are shifted right by the number of positions specified by the right operand <code class="docutils literal notranslate"><span class="pre">rhs</span></code>.
If the type of the left operand is any signed integer type and is negative,
the vacated bits are filled with ones.
Otherwise, vacated bits are filled with zeros.
The expression <code class="docutils literal notranslate"><span class="pre">lhs</span> <span class="pre">&gt;&gt;</span> <span class="pre">rhs</span></code> evaluates to <span class="math notranslate nohighlight">\(\mathrm{lhs} / 2^{\mathrm{rhs}}\)</span>,
cast to the type of the left operand.
If the value of the right operand is negative,
greater than or equal to the width of the left operand,
then the operation results in an out-of-range shift.</p>
<p>This rule applies to the following primitive types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i8</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i16</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i128</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u8</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u16</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u128</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">usize</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">isize</span></code></p></li>
</ul>
<p>Any type can support <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> if you implement the trait:</p>
<div class="rust-example-container docutils container">
<div class="rust-example-code highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">use</span><span class="w"> </span><span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">Shl</span><span class="p">;</span>
<span class="cp">#[allow(dead_code)]</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">MyType</span><span class="p">;</span>

<span class="k">impl</span><span class="w"> </span><span class="n">Shl</span><span class="o">&lt;</span><span class="kt">u32</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="nc">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyType</span><span class="p">;</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">shl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">_rhs</span><span class="p">:</span><span class="w"> </span><span class="kt">u32</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="p">::</span><span class="n">Output</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">MyType</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<script type="application/json" class="rust-example-data">{"code": "use core::ops::Shl;\n#[allow(dead_code)]\nstruct MyType;\n\nimpl Shl<u32> for MyType {\n    type Output = MyType;\n    fn shl(self, _rhs: u32) -> Self::Output { MyType }\n}\n\nfn main() {}", "displayCode": "use core::ops::Shl;\n#[allow(dead_code)]\nstruct MyType;\n\nimpl Shl<u32> for MyType {\n    type Output = MyType;\n    fn shl(self, _rhs: u32) -> Self::Output { MyType }\n}", "hiddenLineNumbers": [8, 9], "edition": "2021", "channel": "stable", "version": "1.85.0", "expectedOutcome": "success", "expectedError": null, "runnable": true, "hasHiddenLines": true, "warnMode": "error", "fullCodeHighlighted": "<span class=\"k\">use</span><span class=\"w\"> </span><span class=\"n\">core</span><span class=\"p\">::</span><span class=\"n\">ops</span><span class=\"p\">::</span><span class=\"n\">Shl</span><span class=\"p\">;</span>\n<span class=\"cp\">#[allow(dead_code)]</span>\n<span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">MyType</span><span class=\"p\">;</span>\n\n<span class=\"k\">impl</span><span class=\"w\"> </span><span class=\"n\">Shl</span><span class=\"o\">&lt;</span><span class=\"kt\">u32</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">MyType</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">type</span><span class=\"w\"> </span><span class=\"nc\">Output</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">MyType</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">fn</span><span class=\"w\"> </span><span class=\"nf\">shl</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">_rhs</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"kt\">u32</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"nc\">Self</span><span class=\"p\">::</span><span class=\"n\">Output</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">MyType</span><span class=\"w\"> </span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n<span class=\"rust-hidden-line\"></span>\n<span class=\"rust-hidden-line\"><span class=\"k\">fn</span><span class=\"w\"> </span><span class=\"nf\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{}</span></span>\n"}</script></div>
<p>You may choose any type for the right operand (not just integers), because you control the implementation.</p>
<p>This rule is based on The CERT C Coding Standard Rule <a class="citation-ref reference internal" href="#cite-gui_RHvQj8BHlz9b-CERT-C-INT34">[CERT-C-INT34]</a>.</p>
<div class="need_container docutils container" id="SNCB-1e775caa">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_rationale docutils align-default" id="rat_3MpR8QfHodGT">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Rationale</span></span>: </span><strong><span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#rat_3MpR8QfHodGT" title="rat_3MpR8QfHodGT">rat_3MpR8QfHodGT</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">parent needs: <span class="parent_needs"><span><a class="reference internal" href="#gui_RHvQj8BHlz9b" title="rat_3MpR8QfHodGT">gui_RHvQj8BHlz9b</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>Avoid out-of-range shifts in shift left and shift right expressions.
Shifting by a negative value, or by a value greater than or equal to the width of the left operand
are non-sensical expressions which typically indicate a logic error has occurred.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-8785c24c">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_non_compliant_example docutils align-default" id="non_compl_ex_O9FZuazu3Lcn">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Non-Compliant Example</span></span>: </span><strong><span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#non_compl_ex_O9FZuazu3Lcn" title="non_compl_ex_O9FZuazu3Lcn">non_compl_ex_O9FZuazu3Lcn</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">parent needs: <span class="parent_needs"><span><a class="reference internal" href="#gui_RHvQj8BHlz9b" title="non_compl_ex_O9FZuazu3Lcn">gui_RHvQj8BHlz9b</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>This noncompliant example shifts by a negative value (-1) and also by greater than or equal to the number of bits that exist in the left operand (40):.</p>
<div class="rust-example-container docutils container">
<div class="rust-example-badges docutils container">
<span class="rust-example-badge rust-example-badge-should-panic">should panic</span></div>
<div class="rust-example-code highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">u32</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">61</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">sh</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;{bits} &lt;&lt; {sh} = {:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">sh</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<script type="application/json" class="rust-example-data">{"code": "fn main() {\n    let bits : u32 = 61;\n    let shifts = vec![-1, 4, 40];\n\n    for sh in shifts {\n        println!(\"{bits} << {sh} = {:?}\", bits << sh);\n    }\n}", "displayCode": "fn main() {\n    let bits : u32 = 61;\n    let shifts = vec![-1, 4, 40];\n\n    for sh in shifts {\n        println!(\"{bits} << {sh} = {:?}\", bits << sh);\n    }\n}", "hiddenLineNumbers": [], "edition": "2021", "channel": "stable", "version": "1.85.0", "expectedOutcome": "should_panic", "expectedError": null, "runnable": true, "hasHiddenLines": false, "warnMode": "error"}</script></div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-7a47ab77">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_non_compliant_example docutils align-default" id="non_compl_ex_mvkgTL3kulZ5">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Non-Compliant Example</span></span>: </span><strong><span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#non_compl_ex_mvkgTL3kulZ5" title="non_compl_ex_mvkgTL3kulZ5">non_compl_ex_mvkgTL3kulZ5</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">parent needs: <span class="parent_needs"><span><a class="reference internal" href="#gui_RHvQj8BHlz9b" title="non_compl_ex_mvkgTL3kulZ5">gui_RHvQj8BHlz9b</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>This noncompliant example tests the value of <code class="docutils literal notranslate"><span class="pre">sh</span></code> to ensure the value of the right operand is negative or greater
than or equal to the width of the left operand.</p>
<div class="rust-example-container docutils container">
<div class="rust-example-code highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">bits</span><span class="p">:</span><span class="w"> </span><span class="kt">u32</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">61</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">sh</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">sh</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">sh</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;{bits} &lt;&lt; {sh} = {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">sh</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">     </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<script type="application/json" class="rust-example-data">{"code": "fn main() {\n    let bits: u32 = 61;\n    let shifts = vec![-1, 0, 4, 40];\n\n    for sh in shifts {\n        if sh >= 0 && sh < 32 {\n            println!(\"{bits} << {sh} = {}\", bits << sh);\n        }\n     }\n}", "displayCode": "fn main() {\n    let bits: u32 = 61;\n    let shifts = vec![-1, 0, 4, 40];\n\n    for sh in shifts {\n        if sh >= 0 && sh < 32 {\n            println!(\"{bits} << {sh} = {}\", bits << sh);\n        }\n     }\n}", "hiddenLineNumbers": [], "edition": "2021", "channel": "stable", "version": "1.85.0", "expectedOutcome": "success", "expectedError": null, "runnable": true, "hasHiddenLines": false, "warnMode": "error"}</script></div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-01f11548">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_non_compliant_example docutils align-default" id="non_compl_ex_O9FZuazu3Lcm">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Non-Compliant Example</span></span>: </span><strong><span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#non_compl_ex_O9FZuazu3Lcm" title="non_compl_ex_O9FZuazu3Lcm">non_compl_ex_O9FZuazu3Lcm</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">parent needs: <span class="parent_needs"><span><a class="reference internal" href="#gui_RHvQj8BHlz9b" title="non_compl_ex_O9FZuazu3Lcm">gui_RHvQj8BHlz9b</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>The call to <code class="docutils literal notranslate"><span class="pre">bits.wrapping_shl(sh)</span></code> in this noncompliant example yields <code class="docutils literal notranslate"><span class="pre">bits</span> <span class="pre">&lt;&lt;</span> <span class="pre">mask(sh)</span></code>,
where <code class="docutils literal notranslate"><span class="pre">mask</span></code> removes any high-order bits of <code class="docutils literal notranslate"><span class="pre">sh</span></code> that would cause the shift to exceed  the bitwidth of <code class="docutils literal notranslate"><span class="pre">bits</span></code>.
Note that this is not the same as a rotate-left.
The <code class="docutils literal notranslate"><span class="pre">wrapping_shl</span></code> has the same behavior as the <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> operator in release mode.</p>
<blockquote>
<div><div class="rust-example-container docutils container">
<div class="rust-example-code highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">u32</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">61</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">sh</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;{bits} &lt;&lt; {sh} = {:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bits</span><span class="p">.</span><span class="n">wrapping_shl</span><span class="p">(</span><span class="n">sh</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<script type="application/json" class="rust-example-data">{"code": "fn main() {\n    let bits : u32 = 61;\n    let shifts = vec![4, 40];\n\n    for sh in shifts {\n        println!(\"{bits} << {sh} = {:?}\", bits.wrapping_shl(sh));\n    }\n}", "displayCode": "fn main() {\n    let bits : u32 = 61;\n    let shifts = vec![4, 40];\n\n    for sh in shifts {\n        println!(\"{bits} << {sh} = {:?}\", bits.wrapping_shl(sh));\n    }\n}", "hiddenLineNumbers": [], "edition": "2021", "channel": "stable", "version": "1.85.0", "expectedOutcome": "success", "expectedError": null, "runnable": true, "hasHiddenLines": false, "warnMode": "error"}</script></div>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-a07f8a0d">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_non_compliant_example docutils align-default" id="non_compl_ex_O9FZuazu3Lcx">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Non-Compliant Example</span></span>: </span><strong><span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#non_compl_ex_O9FZuazu3Lcx" title="non_compl_ex_O9FZuazu3Lcx">non_compl_ex_O9FZuazu3Lcx</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">parent needs: <span class="parent_needs"><span><a class="reference internal" href="#gui_RHvQj8BHlz9b" title="non_compl_ex_O9FZuazu3Lcx">gui_RHvQj8BHlz9b</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>This noncompliant example uses <code class="docutils literal notranslate"><span class="pre">bits.unbounded_shr(sh)</span></code>.
If <code class="docutils literal notranslate"><span class="pre">sh</span></code> is larger or equal to the width of <code class="docutils literal notranslate"><span class="pre">bits</span></code>,
the entire value is shifted out,
which yields 0 for a positive number,
and -1 for a negative number.
The use of this function is noncompliant because it does not detect out-of-range shifts.</p>
<blockquote>
<div><div class="rust-example-container docutils container">
<div class="rust-example-code highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">u32</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">61</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">sh</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;{bits} &lt;&lt; {sh} = {:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bits</span><span class="p">.</span><span class="n">unbounded_shr</span><span class="p">(</span><span class="n">sh</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<script type="application/json" class="rust-example-data">{"code": "fn main() {\n    let bits : u32 = 61;\n    let shifts = vec![4, 40];\n\n    for sh in shifts {\n        println!(\"{bits} << {sh} = {:?}\", bits.unbounded_shr(sh));\n    }\n}", "displayCode": "fn main() {\n    let bits : u32 = 61;\n    let shifts = vec![4, 40];\n\n    for sh in shifts {\n        println!(\"{bits} << {sh} = {:?}\", bits.unbounded_shr(sh));\n    }\n}", "hiddenLineNumbers": [], "edition": "2021", "channel": "stable", "version": "1.87", "expectedOutcome": "success", "expectedError": null, "runnable": true, "hasHiddenLines": false, "warnMode": "error"}</script></div>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-0afc24a7">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_non_compliant_example docutils align-default" id="non_compl_ex_O9FZuazu3Lcp">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Non-Compliant Example</span></span>: </span><strong><span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#non_compl_ex_O9FZuazu3Lcp" title="non_compl_ex_O9FZuazu3Lcp">non_compl_ex_O9FZuazu3Lcp</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">parent needs: <span class="parent_needs"><span><a class="reference internal" href="#gui_RHvQj8BHlz9b" title="non_compl_ex_O9FZuazu3Lcp">gui_RHvQj8BHlz9b</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>The call to <code class="docutils literal notranslate"><span class="pre">bits.overflowing_shl(sh)</span></code> in this noncompliant shifts <code class="docutils literal notranslate"><span class="pre">bits</span></code> left by <code class="docutils literal notranslate"><span class="pre">sh</span></code> bits.
Returns a tuple of the shifted version of self along with a boolean indicating whether the shift value was larger than or equal to the number of bits.
If the shift value is too large, then value is masked (N-1) where N is the number of bits, and this value is used to perform the shift.</p>
<blockquote>
<div><div class="rust-example-container docutils container">
<div class="rust-example-code highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">bits</span><span class="p">:</span><span class="w"> </span><span class="kt">u32</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">61</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">sh</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">overflowed</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bits</span><span class="p">.</span><span class="n">overflowing_shl</span><span class="p">(</span><span class="n">sh</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">overflowed</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;{bits} &lt;&lt; {sh} shift too large&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;{bits} &lt;&lt; {sh} = {result}&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<script type="application/json" class="rust-example-data">{"code": "fn main() {\n    let bits: u32 = 61;\n    let shifts = vec![4, 40];\n\n    for sh in shifts {\n        let (result, overflowed) = bits.overflowing_shl(sh);\n        if overflowed {\n            println!(\"{bits} << {sh} shift too large\");\n        } else {\n            println!(\"{bits} << {sh} = {result}\");\n        }\n    }\n}", "displayCode": "fn main() {\n    let bits: u32 = 61;\n    let shifts = vec![4, 40];\n\n    for sh in shifts {\n        let (result, overflowed) = bits.overflowing_shl(sh);\n        if overflowed {\n            println!(\"{bits} << {sh} shift too large\");\n        } else {\n            println!(\"{bits} << {sh} = {result}\");\n        }\n    }\n}", "hiddenLineNumbers": [], "edition": "2021", "channel": "stable", "version": "1.85.0", "expectedOutcome": "success", "expectedError": null, "runnable": true, "hasHiddenLines": false, "warnMode": "error"}</script></div>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-1862f6a8">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_compliant_example docutils align-default" id="compl_ex_xpPQqYeEPGIo">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Compliant Example</span></span>: </span><strong><span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#compl_ex_xpPQqYeEPGIo" title="compl_ex_xpPQqYeEPGIo">compl_ex_xpPQqYeEPGIo</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">parent needs: <span class="parent_needs"><span><a class="reference internal" href="#gui_RHvQj8BHlz9b" title="compl_ex_xpPQqYeEPGIo">gui_RHvQj8BHlz9b</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>This compliant example performs left shifts via the <a class="std-ref reference external" href="https://doc.rust-lang.org/stable/std/?search=u32%3A%3Achecked_shl"><code class="docutils literal notranslate"><span class="pre">u32::checked_shl</span></code></a>
function and right shifts via the <a class="std-ref reference external" href="https://doc.rust-lang.org/stable/std/?search=u32%3A%3Achecked_shr"><code class="docutils literal notranslate"><span class="pre">u32::checked_shr</span></code></a> function.
Both of these functions are defined in <code class="docutils literal notranslate"><span class="pre">core</span></code>.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">&lt;T&gt;::checked_shl(M)</span></code> returns a value of type <code class="docutils literal notranslate"><span class="pre">Option&lt;T&gt;</span></code>:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">M</span> <span class="pre">&lt;</span> <span class="pre">0</span></code>, the output is <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">M</span> <span class="pre">&lt;</span> <span class="pre">N</span></code> for <code class="docutils literal notranslate"><span class="pre">T</span></code> of size <code class="docutils literal notranslate"><span class="pre">N</span></code> bits, then the output is <code class="docutils literal notranslate"><span class="pre">Some(T)</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">&lt;=</span> <span class="pre">M</span></code>, the output is <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>Checked shift operations make programmer intent explicit and eliminates out-of-range shifts.
Shifting by:</p>
<ul class="simple">
<li><p>negative values is impossible because <code class="docutils literal notranslate"><span class="pre">checked_shl</span></code> only accepts unsigned integers as shift lengths, and</p></li>
<li><p>greater than or equal to the number of bits that exist in the left operand returns a <code class="docutils literal notranslate"><span class="pre">None</span></code> value.</p></li>
</ul>
<div class="rust-example-container docutils container">
<div class="rust-example-code highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">u32</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">61</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// let shifts = vec![-1, 4, 40];</span>
<span class="w">    </span><span class="c1">//                    ^--- Compiler rejects negative shifts</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">sh</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">shifts</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;{bits} &lt;&lt; {sh} = {:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bits</span><span class="p">.</span><span class="n">checked_shl</span><span class="p">(</span><span class="n">sh</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<script type="application/json" class="rust-example-data">{"code": "fn main() {\n    let bits : u32 = 61;\n    // let shifts = vec![-1, 4, 40];\n    //                    ^--- Compiler rejects negative shifts\n    let shifts = vec![4, 40];\n\n    for sh in shifts {\n        println!(\"{bits} << {sh} = {:?}\", bits.checked_shl(sh));\n    }\n}", "displayCode": "fn main() {\n    let bits : u32 = 61;\n    // let shifts = vec![-1, 4, 40];\n    //                    ^--- Compiler rejects negative shifts\n    let shifts = vec![4, 40];\n\n    for sh in shifts {\n        println!(\"{bits} << {sh} = {:?}\", bits.checked_shl(sh));\n    }\n}", "hiddenLineNumbers": [], "edition": "2021", "channel": "stable", "version": "1.85.0", "expectedOutcome": "success", "expectedError": null, "runnable": true, "hasHiddenLines": false, "warnMode": "error"}</script></div>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-d421901f">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_bibliography docutils align-default" id="bib_RHvQj8BHlz9b">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Bibliography</span></span>: </span><strong><span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#bib_RHvQj8BHlz9b" title="bib_RHvQj8BHlz9b">bib_RHvQj8BHlz9b</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">parent needs: <span class="parent_needs"><span><a class="reference internal" href="#gui_RHvQj8BHlz9b" title="bib_RHvQj8BHlz9b">gui_RHvQj8BHlz9b</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><table class="bibliography-table docutils align-default">
<tbody>
<tr class="row-odd"><td><p><span class="target" id="cite-gui_RHvQj8BHlz9b-CERT-C-INT34"></span><strong class="bibentry-key">[CERT-C-INT34]</strong><a href="javascript:void(0)" onclick="citationGoBack('cite-gui_RHvQj8BHlz9b-CERT-C-INT34')" class="bibentry-back" title="Return to citation">↩</a></p></td>
<td><p>SEI CERT C Coding Standard. “INT34-C. Do not shift an expression by a negative number of bits.” <a class="reference external" href="https://wiki.sei.cmu.edu/confluence/x/ItcxBQ">https://wiki.sei.cmu.edu/confluence/x/ItcxBQ</a></p></td>
</tr>
<tr class="row-even"><td><p><span class="target" id="cite-gui_RHvQj8BHlz9b-FLS-BIT-EXPRESSIONS"></span><strong class="bibentry-key">[FLS-BIT-EXPRESSIONS]</strong><a href="javascript:void(0)" onclick="citationGoBack('cite-gui_RHvQj8BHlz9b-FLS-BIT-EXPRESSIONS')" class="bibentry-back" title="Return to citation">↩</a></p></td>
<td><p>The Rust FLS. “Expressions - Bit Expressions.” <a class="reference external" href="https://rust-lang.github.io/fls/expressions.html#bit-expressions">https://rust-lang.github.io/fls/expressions.html#bit-expressions</a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="target" id="cite-gui_RHvQj8BHlz9b-FLS-ISSUE-632"></span><strong class="bibentry-key">[FLS-ISSUE-632]</strong><a href="javascript:void(0)" onclick="citationGoBack('cite-gui_RHvQj8BHlz9b-FLS-ISSUE-632')" class="bibentry-back" title="Return to citation">↩</a></p></td>
<td><p>The Rust FLS Repository. “Issue 632.” <a class="reference external" href="https://github.com/rust-lang/fls/issues/632">https://github.com/rust-lang/fls/issues/632</a></p></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gui_PM8Vpf7lZ51U.html" class="btn btn-neutral float-left" title="An integer shall not be converted to a pointer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gui_dCquvqE1csI3.html" class="btn btn-neutral float-right" title="Ensure that integer operations do not result in arithmetic overflow" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Contributors to Coding Guidelines Subcommittee.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
        This site is powered through <a href="https://www.netlify.com">Netlify</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>