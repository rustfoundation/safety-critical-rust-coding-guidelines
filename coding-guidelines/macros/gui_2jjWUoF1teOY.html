

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>A macro should not be used in place of a function &mdash; Safety-Critical Rust Coding Guidelines 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../_static/rust_playground.css?v=a15f506b" />
      <link rel="stylesheet" type="text/css" href="../../_static/citation.css?v=569c3786" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-data-viewer/jsonview.bundle.css?v=f6ef2277" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/libs/html/datatables.min.css?v=4b4fd840" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/common_css/need_links.css?v=2150a916" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/common_css/need_style.css?v=92936fa5" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/common_css/needstable.css?v=5e1b6797" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/common_css/need_toggle.css?v=5c6620df" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/common_css/need_core.css?v=f5b60a78" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-needs/modern.css?v=803738c0" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=558c75d0" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/rust_playground.js?v=acd109cb"></script>
      <script src="../../_static/citation.js?v=1e6d5203"></script>
      <script src="../../_static/sphinx-data-viewer/jsonview.bundle.js?v=18cd53c5"></script>
      <script src="../../_static/sphinx-data-viewer/jsonview_loader.js?v=f7ff7e7d"></script>
      <script src="../../_static/sphinx-needs/libs/html/datatables.min.js?v=8a4aee21"></script>
      <script src="../../_static/sphinx-needs/libs/html/datatables_loader.js?v=a2cae175"></script>
      <script src="../../_static/sphinx-needs/libs/html/sphinx_needs_collapse.js?v=dca66431"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Procedural macros should not be used" href="gui_66FSqzD55VRZ.html" />
    <link rel="prev" title="Attribute macros shall not be used" href="gui_13XWp3mb0g2P.html" /> 
<link rel="stylesheet" href="../../_static/fls_links.css" type="text/css" />
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Safety-Critical Rust Coding Guidelines
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Coding Guidelines</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../types-and-traits/index.html">Types and Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/index.html">Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../expressions/index.html">Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../values/index.html">Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statements/index.html">Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions/index.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../associated-items/index.html">Associated Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="../implementations/index.html">Implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generics/index.html">Generics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../attributes/index.html">Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entities-and-resolution/index.html">Entities And Resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ownership-and-destruction/index.html">Ownership And Destruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exceptions-and-errors/index.html">Exceptions And Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concurrency/index.html">Concurrency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../program-structure-and-compilation/index.html">Program Structure And Compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unsafety/index.html">Unsafety</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Macros</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="gui_13XWp3mb0g2P.html">Attribute macros shall not be used</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">A macro should not be used in place of a function</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_66FSqzD55VRZ.html">Procedural macros should not be used</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_8hs33nyp0ipX.html">Shall ensure complete hygiene of macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_FRLaMIMb4t3S.html">Do not hide unsafe blocks within macro expansions</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_SJMrWDYZ0dN4.html">Names in a macro definition shall use a fully qualified path</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_WJlWqgIxmE8P.html">Shall not use Function-like Macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_a1mHfjgKk4Xr.html">Shall not invoke macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_h0uG1C9ZjryA.html">Shall not use Declarative Macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_uuDOArzyO3Qw.html">Shall not write code that expands macros</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ffi/index.html">Ffi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inline-assembly/index.html">Inline Assembly</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../compliance/index.html">Compliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/index.html">Appendices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../retired-guidelines/index.html">Retired Guidelines</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Safety-Critical Rust Coding Guidelines</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Coding Guidelines</a></li>
          <li class="breadcrumb-item"><a href="index.html">Macros</a></li>
      <li class="breadcrumb-item active">A macro should not be used in place of a function</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/coding-guidelines/macros/gui_2jjWUoF1teOY.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="a-macro-should-not-be-used-in-place-of-a-function">
<h1>A macro should not be used in place of a function<a class="headerlink" href="#a-macro-should-not-be-used-in-place-of-a-function" title="Link to this heading"></a></h1>
<div class="need_container docutils container" id="SNCB-5d46d01e">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_guideline docutils align-default" id="gui_2jjWUoF1teOY">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Guideline</span></span>: </span><strong><span><span class="needs_title"><span class="needs_data">A macro should not be used in place of a function</span></span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#gui_2jjWUoF1teOY" title="gui_2jjWUoF1teOY">gui_2jjWUoF1teOY</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
<div class="line"><span class="needs_tags"><span class="needs_label">tags: </span><span class="needs_data_container"><span class="needs_data">reduce-human-error</span></span></span></div>
<div class="line"><span class="needs_category"><span class="needs_label">category: </span><span class="needs_data">mandatory</span></span></div>
<div class="line"><span class="needs_fls"><span class="needs_label">fls: </span><span class="needs_data"><a href="https://rust-lang.github.io/fls/macros.html#declarative-macros" class="fls-id">fls_xa7lp0zg1ol2</a></span></span></div>
<div class="line"><span class="needs_decidability"><span class="needs_label">decidability: </span><span class="needs_data">decidable</span></span></div>
<div class="line"><span class="needs_scope"><span class="needs_label">scope: </span><span class="needs_data">system</span></span></div>
<div class="line"><span class="needs_release"><span class="needs_label">release: </span><span class="needs_data">todo</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">child needs: <span class="parent_needs"><span><a class="reference internal" href="#rat_M9bp23ctkzQ7" title="gui_2jjWUoF1teOY">rat_M9bp23ctkzQ7</a>, <a class="reference internal" href="#non_compl_ex_TZgk2vG42t2r" title="gui_2jjWUoF1teOY">non_compl_ex_TZgk2vG42t2r</a>, <a class="reference internal" href="#compl_ex_iPTgzrvO7qr3" title="gui_2jjWUoF1teOY">compl_ex_iPTgzrvO7qr3</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>Functions should always be preferred over macros, except when macros provide essential functionality that functions cannot, such as variadic interfaces, compile-time code generation, or syntax extensions via custom derive and attribute macros.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="need_container docutils container" id="SNCB-63a699c5">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_rationale docutils align-default" id="rat_M9bp23ctkzQ7">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Rationale</span></span>: </span><strong><span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#rat_M9bp23ctkzQ7" title="rat_M9bp23ctkzQ7">rat_M9bp23ctkzQ7</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">parent needs: <span class="parent_needs"><span><a class="reference internal" href="#gui_2jjWUoF1teOY" title="rat_M9bp23ctkzQ7">gui_2jjWUoF1teOY</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>Although the compiler reports both the macro expansion and its invocation site, diagnostics originating within macros can be more difficult to interpret than those from ordinary function or type definitions. Complex or deeply nested macros may obscure intent and hinder static analysis, increasing the risk of misinterpretation or overlooked errors during code review.</p>
<p><strong>Debugging Complexity</strong></p>
<ul class="simple">
<li><p>Errors point to expanded code rather than source locations, making it difficult to trace compile-time errors back to the original macro invocation.</p></li>
</ul>
<p><strong>Optimization</strong></p>
<ul class="simple">
<li><p>Macros may inhibit compiler optimizations that work better with functions.</p></li>
<li><p>Macros act like <code class="docutils literal notranslate"><span class="pre">#[inline(always)]</span></code> functions, which can lead to code bloat.</p></li>
<li><p>They don’t benefit from the compiler’s inlining heuristics, missing out on selective inlining where the compiler decides when inlining is beneficial.</p></li>
</ul>
<p><strong>Functions provide</strong></p>
<ul class="simple">
<li><p>Clear type signatures.</p></li>
<li><p>Predictable behavior.</p></li>
<li><p>Proper stack traces.</p></li>
<li><p>Consistent optimization opportunities.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-652c90b2">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_non_compliant_example docutils align-default" id="non_compl_ex_TZgk2vG42t2r">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Non-Compliant Example</span></span>: </span><strong><span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#non_compl_ex_TZgk2vG42t2r" title="non_compl_ex_TZgk2vG42t2r">non_compl_ex_TZgk2vG42t2r</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">parent needs: <span class="parent_needs"><span><a class="reference internal" href="#gui_2jjWUoF1teOY" title="non_compl_ex_TZgk2vG42t2r">gui_2jjWUoF1teOY</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>Using a macro where a simple function would suffice, leads to hidden mutation:</p>
<div class="rust-example-container docutils container">
<div class="rust-example-code highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="fm">macro_rules!</span><span class="w"> </span><span class="n">increment_and_double</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="cp">$x</span><span class="p">:</span><span class="nc">expr</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="cp">$x</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// mutation is implicit</span>
<span class="w">            </span><span class="cp">$x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>

<span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">increment_and_double</span><span class="o">!</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>
<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;Result: {}, Num: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">num</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Result: 12, Num: 6</span>
<span class="p">}</span>
</pre></div>
</div>
<script type="application/json" class="rust-example-data">{"code": "macro_rules! increment_and_double {\n    ($x:expr) => {\n        {\n            $x += 1; // mutation is implicit\n            $x * 2\n        }\n    };\n}\n\nfn main() {\n    let mut num = 5;\n    let result = increment_and_double!(num);\n    println!(\"Result: {}, Num: {}\", result, num);\n    // Result: 12, Num: 6\n}", "displayCode": "macro_rules! increment_and_double {\n    ($x:expr) => {\n        {\n            $x += 1; // mutation is implicit\n            $x * 2\n        }\n    };\n}\n\nfn main() {\n    let mut num = 5;\n    let result = increment_and_double!(num);\n    println!(\"Result: {}, Num: {}\", result, num);\n    // Result: 12, Num: 6\n}", "hiddenLineNumbers": [], "edition": "2021", "channel": "stable", "version": "1.85.0", "expectedOutcome": "success", "expectedError": null, "runnable": true, "hasHiddenLines": false, "warnMode": "error"}</script></div>
<p>In this example, calling the macro both increments and returns the value in one go—without any clear indication in its “signature” that it mutates its argument. As a result, num is changed behind the scenes, which can surprise readers and make debugging more difficult.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="need_container docutils container" id="SNCB-ad7361ac">
<table class="need needs_grid_simple needs_layout_clean needs_style_none needs_type_compliant_example docutils align-default" id="compl_ex_iPTgzrvO7qr3">
<tbody>
<tr class="need head row-odd"><td class="need head"><div class="needs_head line-block">
<div class="line"><span><span class="needs_type_name"><span class="needs_data">Compliant Example</span></span>: </span><strong><span></span></strong><span> <span class="needs-id"><a class="reference internal" href="#compl_ex_iPTgzrvO7qr3" title="compl_ex_iPTgzrvO7qr3">compl_ex_iPTgzrvO7qr3</a></span>  <span class="needs needs_collapse" id="target__show__meta"><span class="needs collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-down-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line></svg></span><span class="needs visible collapse_is_hidden"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span></span> </span></div>
</div>
</td>
</tr>
<tr class="need meta row-even"><td class="need meta"><div class="needs_meta line-block">
<div class="line"><span><span><div class="line"><span class="needs_status"><span class="needs_label">status: </span><span class="needs_data">draft</span></span></div>
</span></span></div>
<div class="line"><span><div class="line">parent needs: <span class="parent_needs"><span><a class="reference internal" href="#gui_2jjWUoF1teOY" title="compl_ex_iPTgzrvO7qr3">gui_2jjWUoF1teOY</a></span></span></div>
</span></div>
</div>
</td>
</tr>
<tr class="need content row-odd"><td class="need content" colspan="1"><p>The same functionality, implemented as a function with explicit borrowing:</p>
<div class="rust-example-container docutils container">
<div class="rust-example-code highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="nf">increment_and_double</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="kt">i32</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">i32</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// mutation is explicit</span>
<span class="w">    </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span>
<span class="p">}</span>

<span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">increment_and_double</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">num</span><span class="p">);</span>
<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;Result: {}, Num: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">num</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Result: 12, Num: 6</span>
<span class="p">}</span>
</pre></div>
</div>
<script type="application/json" class="rust-example-data">{"code": "fn increment_and_double(x: &mut i32) -> i32 {\n    *x += 1; // mutation is explicit\n    *x * 2\n}\n\nfn main() {\n    let mut num = 5;\n    let result = increment_and_double(&mut num);\n    println!(\"Result: {}, Num: {}\", result, num);\n    // Result: 12, Num: 6\n}", "displayCode": "fn increment_and_double(x: &mut i32) -> i32 {\n    *x += 1; // mutation is explicit\n    *x * 2\n}\n\nfn main() {\n    let mut num = 5;\n    let result = increment_and_double(&mut num);\n    println!(\"Result: {}, Num: {}\", result, num);\n    // Result: 12, Num: 6\n}", "hiddenLineNumbers": [], "edition": "2021", "channel": "stable", "version": "1.85.0", "expectedOutcome": "success", "expectedError": null, "runnable": true, "hasHiddenLines": false, "warnMode": "error"}</script></div>
<p>The function version makes the mutation and borrowing explicit in its signature, improving readability, safety, and debuggability.</p>
</td>
</tr>
</tbody>
</table>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gui_13XWp3mb0g2P.html" class="btn btn-neutral float-left" title="Attribute macros shall not be used" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gui_66FSqzD55VRZ.html" class="btn btn-neutral float-right" title="Procedural macros should not be used" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Contributors to Coding Guidelines Subcommittee.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
        This site is powered through <a href="https://www.netlify.com">Netlify</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>